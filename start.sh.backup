#!/bin/bash

# Set default port if not provided
PORT=${PORT:-8000}

# Validate that PORT is a number
if ! [[ "$PORT" =~ ^[0-9]+$ ]]; then
    echo "Error: PORT '$PORT' is not a valid number, using default 8000"
    PORT=8000
fi

echo "Starting server on port $PORT"

# Run migrations
python manage.py migrate --noinput

# Collect static files
python manage.py collectstatic --noinput

# Start gunicorn
exec gunicorn --bind 0.0.0.0:$PORT ml_chatbot.wsgi:application
